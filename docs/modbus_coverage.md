# Neptun Smart Modbus Coverage

Источник сверки: `docs/modbus_registers.xlsx`.

## DONE

- Регистр `0` (конфигурация/статус модуля):
  - чтение основных флагов;
  - запись управляющих битов через `switch`:
    - зона 1, зона 2, зона 1+2;
    - dual zone;
    - floor washing;
    - keypad lock;
    - close taps on sensor lost;
    - add new sensor (pairing).
- Регистр `3` (статус проводных линий):
  - чтение `LeakSensor N` (автодетект количества линий).
- Регистр `6` (кол-во беспроводных датчиков):
  - чтение и автодетект беспроводных датчиков.
- Регистры `57..106` (статус беспроводных датчиков):
  - чтение raw/тревога/потеря/категория/уровень сигнала/батарея.
- Регистры `107..122` (показания счетчиков):
  - чтение 8 счетчиков (`int32`, масштаб `0.001 м³`);
  - запись для калибровки текущего значения (`number`: `Counter N Calibration`).
- Регистры `123..130` (настройки счетчиков):
  - чтение шага, статуса, connection type, namur error;
  - запись шага счета (`select`: `Counter N Step`, варианты `1/10/100`).
- Автодетект установленных счетчиков:
  - по биту статуса в регистрах `123..130`;
  - создание counter-сущностей только для обнаруженных модулей.
- Диагностическая разметка:
  - служебные сущности вынесены в `diagnostic` и отключены по умолчанию.

## TODO

- Регистр `1` (конфигурация входов линий 1/2):
  - нет сущностей для чтения/записи `тип входа` и `группа кранов`.
- Регистр `2` (конфигурация входов линий 3/4):
  - нет сущностей для чтения/записи `тип входа` и `группа кранов`.
- Регистр `4` (конфигурация реле событий):
  - не реализовано чтение/запись.
- Регистр `5` (адрес Modbus и скорость порта):
  - не реализовано чтение/запись.
- Регистры `7..56` (параметры беспроводных датчиков 1..50):
  - не реализовано чтение/запись групп отработки событий.
- Регистры `123..130` (настройки счетчиков), запись неполная:
  - нет записи `тип подключения` (бит `1`);
  - нет записи `статус счетчика` (бит `0`).
- Регистр `0` (битовая часть), неполное покрытие switch-сущностями:
  - нет отдельных сущностей для битов `5` и `6`
    (закрытие группы 1/2 при потере беспроводных датчиков).
